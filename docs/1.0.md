# Consul指南
## 什么是Consul
Consul提供了服务发现\注册和配置管理服务等常用工具
## 有哪些功能
* 服务发现\注册
* 健康检查
* Key/Value存储
* 多数据中心

### 服务发现\注册
服务注册：可以将应用程序注册到Consul集群中。
服务发现：应用程序可以使用Consul发现服务的提供者。使用DNS或者HTTP，可以找到它他们所依赖的服务。
### 健康检查
可以给注册在Consul上的服务提供健康检测查功能（比如服务是否返回200OK状态）。操作员也可以使用些功能来监视群集的健康状况，并且服务发现组件可以使用该信息将流量远离不正常的主机。
### Key/Value存储
应用程序可以使用Consul的带有层级的功能的键/值格式存储数据。包括：动态配置、功能标记、协调、领导选举等。它提供了简单的HTTP接口来使用。
### 多数据中心
Consul支持多个数据中心
## Consul架构
Consul是一个分布式的、高可用的系统。
### Consul agent
agent包含两种模式：
* server
* client

server主要负责consul clustor的领导选举，日志复制、存储集群状态数据等功能
clinet在集群中是无状态的，并且严重依赖server节点。主要用于将数据发送到server端

提供服务的每个节点上都运行着一个agent。运行agent不需要发现其它服务或者获取\设置健值数据。agent负责健康检查节点上的服务以及节点本身。agent与一个或者多个Consul server进行通信。

Consul server是用来存储和复制数据，Consul server集群会自已选举领导者。集群节点数据最好是3到5个，以免导致数据丢失故障的情况。建议为每个数据中心建立一个Consul server集群。每个数据中心运行一个Consul server集群。当进行跨数据中心服务发现或配置请求时，本地Consul server将请求转发到远程数据中心并返回结果。